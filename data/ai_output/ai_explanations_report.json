{
  "report_version": "1.0",
  "generated_at": "2026-02-08T21:46:04.541941",
  "inputs_present": {
    "metadata": true,
    "audit_events": 68,
    "pipeline_log_chars": 142721,
    "ml_performance": true,
    "anomaly_datasets": [
      "weather",
      "activity",
      "station"
    ]
  },
  "data_quality": {
    "datasets": [
      {
        "dataset": "ingested_Weather.csv",
        "row_count": 50000,
        "column_count": 6,
        "missing_values": {
          "stationid": 0,
          "observationdate": 24920,
          "rainfall": 4952,
          "rain_unit": 9937,
          "temperature": 2488,
          "temperature_unit": 0
        },
        "missing_pct": {
          "stationid": 0.0,
          "observationdate": 49.84,
          "rainfall": 9.9,
          "rain_unit": 19.87,
          "temperature": 4.98,
          "temperature_unit": 0.0
        },
        "top_missing_columns": [
          {
            "column": "observationdate",
            "missing_pct": 49.84
          },
          {
            "column": "rain_unit",
            "missing_pct": 19.87
          },
          {
            "column": "rainfall",
            "missing_pct": 9.9
          },
          {
            "column": "temperature",
            "missing_pct": 4.98
          },
          {
            "column": "stationid",
            "missing_pct": 0.0
          }
        ],
        "dtypes": {
          "stationid": "object",
          "observationdate": "datetime64[ns]",
          "rainfall": "float64",
          "rain_unit": "object",
          "temperature": "float64",
          "temperature_unit": "object"
        }
      },
      {
        "dataset": "ingested_Station Region.csv",
        "row_count": 800,
        "column_count": 3,
        "missing_values": {
          "stationcode": 0,
          "region": 0,
          "region_type": 0
        },
        "missing_pct": {
          "stationcode": 0.0,
          "region": 0.0,
          "region_type": 0.0
        },
        "top_missing_columns": [
          {
            "column": "stationcode",
            "missing_pct": 0.0
          },
          {
            "column": "region",
            "missing_pct": 0.0
          },
          {
            "column": "region_type",
            "missing_pct": 0.0
          }
        ],
        "dtypes": {
          "stationcode": "object",
          "region": "object",
          "region_type": "object"
        }
      },
      {
        "dataset": "ingested_Activity Logs.csv",
        "row_count": 30000,
        "column_count": 5,
        "missing_values": {
          "region": 0,
          "activitydate": 20029,
          "croptype": 0,
          "irrigationhours": 3039,
          "fertilizer_amount": 4476
        },
        "missing_pct": {
          "region": 0.0,
          "activitydate": 66.76,
          "croptype": 0.0,
          "irrigationhours": 10.13,
          "fertilizer_amount": 14.92
        },
        "top_missing_columns": [
          {
            "column": "activitydate",
            "missing_pct": 66.76
          },
          {
            "column": "fertilizer_amount",
            "missing_pct": 14.92
          },
          {
            "column": "irrigationhours",
            "missing_pct": 10.13
          },
          {
            "column": "region",
            "missing_pct": 0.0
          },
          {
            "column": "croptype",
            "missing_pct": 0.0
          }
        ],
        "dtypes": {
          "region": "object",
          "activitydate": "datetime64[ns]",
          "croptype": "object",
          "irrigationhours": "float64",
          "fertilizer_amount": "float64"
        }
      },
      {
        "dataset": "ingested_Reference Units.csv",
        "row_count": 4,
        "column_count": 3,
        "missing_values": {
          "unit": 0,
          "standard_unit": 1,
          "conversion_factor": 1
        },
        "missing_pct": {
          "unit": 0.0,
          "standard_unit": 25.0,
          "conversion_factor": 25.0
        },
        "top_missing_columns": [
          {
            "column": "standard_unit",
            "missing_pct": 25.0
          },
          {
            "column": "conversion_factor",
            "missing_pct": 25.0
          },
          {
            "column": "unit",
            "missing_pct": 0.0
          }
        ],
        "dtypes": {
          "unit": "object",
          "standard_unit": "object",
          "conversion_factor": "float64"
        }
      }
    ],
    "pipeline_signals": {
      "errors": [
        "2026-02-06 12:03:12,873 - __main__ - ERROR - Pipeline failed: X has 8 features, but StandardScaler is expecting 5 features as input.",
        "2026-02-06 12:03:12,888 - __main__ - ERROR - Pipeline failed: X has 8 features, but StandardScaler is expecting 5 features as input.",
        "2026-02-06 12:05:28,449 - __main__ - ERROR - Pipeline failed: Input X contains NaN.",
        "2026-02-06 12:05:28,452 - __main__ - ERROR - Pipeline failed: Input X contains NaN.",
        "2026-02-08 19:34:03,603 - __main__ - ERROR - Failed to validate Weather.csv: Object of type Series is not JSON serializable",
        "2026-02-08 19:34:03,608 - governance.audit_logger - ERROR - Audit: Error logged - Object of type Series is not JSON serializable",
        "2026-02-08 19:34:03,608 - __main__ - ERROR - Failed to filter Weather.csv: 'valid_rows'",
        "2026-02-08 19:34:03,608 - governance.audit_logger - ERROR - Audit: Error logged - 'valid_rows'",
        "2026-02-08 19:34:03,971 - __main__ - ERROR - Failed to validate Station Region.csv: Object of type Series is not JSON serializable",
        "2026-02-08 19:34:03,971 - governance.audit_logger - ERROR - Audit: Error logged - Object of type Series is not JSON serializable",
        "2026-02-08 19:34:03,986 - __main__ - ERROR - Failed to filter Station Region.csv: 'valid_rows'",
        "2026-02-08 19:34:03,986 - governance.audit_logger - ERROR - Audit: Error logged - 'valid_rows'",
        "2026-02-08 19:34:04,204 - __main__ - ERROR - Failed to validate Activity Logs.csv: Object of type Series is not JSON serializable",
        "2026-02-08 19:34:04,208 - governance.audit_logger - ERROR - Audit: Error logged - Object of type Series is not JSON serializable",
        "2026-02-08 19:34:04,210 - __main__ - ERROR - Failed to filter Activity Logs.csv: 'valid_rows'",
        "2026-02-08 19:34:04,210 - governance.audit_logger - ERROR - Audit: Error logged - 'valid_rows'",
        "2026-02-08 19:34:04,411 - __main__ - ERROR - Failed to validate Reference Units.csv: Object of type Series is not JSON serializable",
        "2026-02-08 19:34:04,411 - governance.audit_logger - ERROR - Audit: Error logged - Object of type Series is not JSON serializable",
        "2026-02-08 19:34:04,411 - __main__ - ERROR - Failed to filter Reference Units.csv: 'valid_rows'",
        "2026-02-08 19:34:04,411 - governance.audit_logger - ERROR - Audit: Error logged - 'valid_rows'",
        "2026-02-08 19:43:14,295 - __main__ - ERROR - Failed to validate Weather.csv: Object of type Series is not JSON serializable",
        "2026-02-08 19:43:14,295 - governance.audit_logger - ERROR - Audit: Error logged - Object of type Series is not JSON serializable",
        "2026-02-08 19:43:14,295 - __main__ - ERROR - Failed to filter Weather.csv: 'valid_rows'",
        "2026-02-08 19:43:14,308 - governance.audit_logger - ERROR - Audit: Error logged - 'valid_rows'",
        "2026-02-08 19:43:14,657 - __main__ - ERROR - Failed to validate Station Region.csv: Object of type Series is not JSON serializable",
        "2026-02-08 19:43:14,666 - governance.audit_logger - ERROR - Audit: Error logged - Object of type Series is not JSON serializable",
        "2026-02-08 19:43:14,666 - __main__ - ERROR - Failed to filter Station Region.csv: 'valid_rows'",
        "2026-02-08 19:43:14,666 - governance.audit_logger - ERROR - Audit: Error logged - 'valid_rows'",
        "2026-02-08 19:43:14,911 - __main__ - ERROR - Failed to validate Activity Logs.csv: Object of type Series is not JSON serializable",
        "2026-02-08 19:43:14,911 - governance.audit_logger - ERROR - Audit: Error logged - Object of type Series is not JSON serializable",
        "2026-02-08 19:43:14,911 - __main__ - ERROR - Failed to filter Activity Logs.csv: 'valid_rows'",
        "2026-02-08 19:43:14,911 - governance.audit_logger - ERROR - Audit: Error logged - 'valid_rows'",
        "2026-02-08 19:43:15,149 - __main__ - ERROR - Failed to validate Reference Units.csv: Object of type Series is not JSON serializable",
        "2026-02-08 19:43:15,149 - governance.audit_logger - ERROR - Audit: Error logged - Object of type Series is not JSON serializable",
        "2026-02-08 19:43:15,149 - __main__ - ERROR - Failed to filter Reference Units.csv: 'valid_rows'",
        "2026-02-08 19:43:15,149 - governance.audit_logger - ERROR - Audit: Error logged - 'valid_rows'"
      ],
      "warnings": [
        "2026-02-08 19:34:03,495 - validation.schema_validator - WARNING - Found 29008 rows with duplicate keys on ['stationid', 'observationdate']",
        "2026-02-08 19:34:03,508 - validation.schema_validator - WARNING - Found 2488 rows with type validation failures",
        "2026-02-08 19:34:03,519 - validation.quality_checker - WARNING - Found 29 rows with >50% missing values",
        "2026-02-08 19:34:03,540 - validation.quality_checker - WARNING - Required field 'observationdate' has 24920 null values",
        "2026-02-08 19:34:03,540 - validation.quality_checker - WARNING - Required field 'temperature' has 2488 null values",
        "2026-02-08 19:34:03,555 - validation.quality_checker - WARNING - Required column 'observationdate' is only 50.2% complete",
        "2026-02-08 19:34:03,593 - validation.quality_checker - WARNING - Found 29 rows with >50% missing values",
        "2026-02-08 19:34:03,593 - validation.quality_checker - WARNING - Required field 'observationdate' has 24920 null values",
        "2026-02-08 19:34:03,603 - validation.quality_checker - WARNING - Required field 'temperature' has 2488 null values",
        "2026-02-08 19:34:03,971 - validation.schema_validator - WARNING - Found 680 rows with duplicate keys on ['stationcode']",
        "2026-02-08 19:34:03,971 - validation.quality_checker - WARNING - Found 82 exact duplicate rows (action: flag)",
        "2026-02-08 19:34:04,145 - validation.quality_checker - WARNING - Found 277 rows with >50% missing values",
        "2026-02-08 19:34:04,162 - validation.quality_checker - WARNING - Found 277 exact duplicate rows (action: flag)",
        "2026-02-08 19:34:04,162 - validation.quality_checker - WARNING - Required field 'activitydate' has 20029 null values",
        "2026-02-08 19:34:04,184 - validation.quality_checker - WARNING - Required column 'activitydate' is only 33.2% complete",
        "2026-02-08 19:34:04,198 - validation.quality_checker - WARNING - Found 277 rows with >50% missing values",
        "2026-02-08 19:34:04,204 - validation.quality_checker - WARNING - Required field 'activitydate' has 20029 null values",
        "2026-02-08 19:43:14,196 - validation.schema_validator - WARNING - Found 29008 rows with duplicate keys on ['stationid', 'observationdate']",
        "2026-02-08 19:43:14,211 - validation.schema_validator - WARNING - Found 2488 rows with type validation failures",
        "2026-02-08 19:43:14,212 - validation.quality_checker - WARNING - Found 29 rows with >50% missing values",
        "2026-02-08 19:43:14,244 - validation.quality_checker - WARNING - Required field 'observationdate' has 24920 null values",
        "2026-02-08 19:43:14,244 - validation.quality_checker - WARNING - Required field 'temperature' has 2488 null values",
        "2026-02-08 19:43:14,260 - validation.quality_checker - WARNING - Required column 'observationdate' is only 50.2% complete",
        "2026-02-08 19:43:14,293 - validation.quality_checker - WARNING - Found 29 rows with >50% missing values",
        "2026-02-08 19:43:14,295 - validation.quality_checker - WARNING - Required field 'observationdate' has 24920 null values",
        "2026-02-08 19:43:14,295 - validation.quality_checker - WARNING - Required field 'temperature' has 2488 null values",
        "2026-02-08 19:43:14,656 - validation.schema_validator - WARNING - Found 680 rows with duplicate keys on ['stationcode']",
        "2026-02-08 19:43:14,657 - validation.quality_checker - WARNING - Found 82 exact duplicate rows (action: flag)",
        "2026-02-08 19:43:14,864 - validation.quality_checker - WARNING - Found 277 rows with >50% missing values",
        "2026-02-08 19:43:14,864 - validation.quality_checker - WARNING - Found 277 exact duplicate rows (action: flag)",
        "2026-02-08 19:43:14,879 - validation.quality_checker - WARNING - Required field 'activitydate' has 20029 null values",
        "2026-02-08 19:43:14,879 - validation.quality_checker - WARNING - Required column 'activitydate' is only 33.2% complete",
        "2026-02-08 19:43:14,896 - validation.quality_checker - WARNING - Found 277 rows with >50% missing values",
        "2026-02-08 19:43:14,910 - validation.quality_checker - WARNING - Required field 'activitydate' has 20029 null values",
        "2026-02-08 19:58:27,850 - validation.schema_validator - WARNING - Found 29008 rows with duplicate keys on ['stationid', 'observationdate']",
        "2026-02-08 19:58:27,871 - validation.schema_validator - WARNING - Found 2488 rows with type validation failures",
        "2026-02-08 19:58:27,913 - validation.quality_checker - WARNING - Found 29 rows with >50% missing values",
        "2026-02-08 19:58:27,978 - validation.quality_checker - WARNING - Required field 'observationdate' has 24920 null values",
        "2026-02-08 19:58:27,978 - validation.quality_checker - WARNING - Required field 'temperature' has 2488 null values",
        "2026-02-08 19:58:28,016 - validation.quality_checker - WARNING - Required column 'observationdate' is only 50.2% complete",
        "2026-02-08 19:58:28,101 - validation.quality_checker - WARNING - Found 29 rows with >50% missing values",
        "2026-02-08 19:58:28,137 - validation.quality_checker - WARNING - Required field 'observationdate' has 24920 null values",
        "2026-02-08 19:58:28,139 - validation.quality_checker - WARNING - Required field 'temperature' has 2488 null values",
        "2026-02-08 19:58:28,735 - validation.schema_validator - WARNING - Found 680 rows with duplicate keys on ['stationcode']",
        "2026-02-08 19:58:28,745 - validation.quality_checker - WARNING - Found 82 exact duplicate rows (action: flag)",
        "2026-02-08 19:58:29,254 - validation.quality_checker - WARNING - Found 277 rows with >50% missing values",
        "2026-02-08 19:58:29,258 - validation.quality_checker - WARNING - Found 277 exact duplicate rows (action: flag)",
        "2026-02-08 19:58:29,269 - validation.quality_checker - WARNING - Required field 'activitydate' has 20029 null values",
        "2026-02-08 19:58:29,286 - validation.quality_checker - WARNING - Required column 'activitydate' is only 33.2% complete",
        "2026-02-08 19:58:29,301 - validation.quality_checker - WARNING - Found 277 rows with >50% missing values",
        "2026-02-08 19:58:29,318 - validation.quality_checker - WARNING - Required field 'activitydate' has 20029 null values",
        "2026-02-08 20:01:49,709 - validation.schema_validator - WARNING - Found 29008 rows with duplicate keys on ['stationid', 'observationdate']",
        "2026-02-08 20:01:49,720 - validation.schema_validator - WARNING - Found 2488 rows with type validation failures",
        "2026-02-08 20:01:49,772 - validation.quality_checker - WARNING - Found 29 rows with >50% missing values",
        "2026-02-08 20:01:49,835 - validation.quality_checker - WARNING - Required field 'observationdate' has 24920 null values",
        "2026-02-08 20:01:49,835 - validation.quality_checker - WARNING - Required field 'temperature' has 2488 null values",
        "2026-02-08 20:01:49,902 - validation.quality_checker - WARNING - Required column 'observationdate' is only 50.2% complete",
        "2026-02-08 20:01:49,997 - validation.quality_checker - WARNING - Found 29 rows with >50% missing values",
        "2026-02-08 20:01:50,029 - validation.quality_checker - WARNING - Required field 'observationdate' has 24920 null values",
        "2026-02-08 20:01:50,034 - validation.quality_checker - WARNING - Required field 'temperature' has 2488 null values",
        "2026-02-08 20:01:50,576 - validation.schema_validator - WARNING - Found 680 rows with duplicate keys on ['stationcode']",
        "2026-02-08 20:01:50,584 - validation.quality_checker - WARNING - Found 82 exact duplicate rows (action: flag)",
        "2026-02-08 20:01:50,986 - validation.quality_checker - WARNING - Found 277 rows with >50% missing values",
        "2026-02-08 20:01:50,990 - validation.quality_checker - WARNING - Found 277 exact duplicate rows (action: flag)",
        "2026-02-08 20:01:50,990 - validation.quality_checker - WARNING - Required field 'activitydate' has 20029 null values",
        "2026-02-08 20:01:51,024 - validation.quality_checker - WARNING - Required column 'activitydate' is only 33.2% complete",
        "2026-02-08 20:01:51,076 - validation.quality_checker - WARNING - Found 277 rows with >50% missing values",
        "2026-02-08 20:01:51,096 - validation.quality_checker - WARNING - Required field 'activitydate' has 20029 null values",
        "2026-02-08 20:03:04,734 - validation.schema_validator - WARNING - Found 29008 rows with duplicate keys on ['stationid', 'observationdate']",
        "2026-02-08 20:03:04,755 - validation.schema_validator - WARNING - Found 2488 rows with type validation failures",
        "2026-02-08 20:03:04,791 - validation.quality_checker - WARNING - Found 29 rows with >50% missing values",
        "2026-02-08 20:03:04,850 - validation.quality_checker - WARNING - Required field 'observationdate' has 24920 null values",
        "2026-02-08 20:03:04,856 - validation.quality_checker - WARNING - Required field 'temperature' has 2488 null values",
        "2026-02-08 20:03:04,897 - validation.quality_checker - WARNING - Required column 'observationdate' is only 50.2% complete",
        "2026-02-08 20:03:04,997 - validation.quality_checker - WARNING - Found 29 rows with >50% missing values",
        "2026-02-08 20:03:05,016 - validation.quality_checker - WARNING - Required field 'observationdate' has 24920 null values",
        "2026-02-08 20:03:05,016 - validation.quality_checker - WARNING - Required field 'temperature' has 2488 null values",
        "2026-02-08 20:03:05,599 - validation.schema_validator - WARNING - Found 680 rows with duplicate keys on ['stationcode']",
        "2026-02-08 20:03:05,604 - validation.quality_checker - WARNING - Found 82 exact duplicate rows (action: flag)",
        "2026-02-08 20:03:06,077 - validation.quality_checker - WARNING - Found 277 rows with >50% missing values",
        "2026-02-08 20:03:06,104 - validation.quality_checker - WARNING - Found 277 exact duplicate rows (action: flag)",
        "2026-02-08 20:03:06,121 - validation.quality_checker - WARNING - Required field 'activitydate' has 20029 null values",
        "2026-02-08 20:03:06,136 - validation.quality_checker - WARNING - Required column 'activitydate' is only 33.2% complete",
        "2026-02-08 20:03:06,160 - validation.quality_checker - WARNING - Found 277 rows with >50% missing values",
        "2026-02-08 20:03:06,174 - validation.quality_checker - WARNING - Required field 'activitydate' has 20029 null values",
        "2026-02-08 21:46:03,101 - validation.schema_validator - WARNING - Found 29008 rows with duplicate keys on ['stationid', 'observationdate']",
        "2026-02-08 21:46:03,115 - validation.schema_validator - WARNING - Found 2488 rows with type validation failures",
        "2026-02-08 21:46:03,131 - validation.quality_checker - WARNING - Found 29 rows with >50% missing values",
        "2026-02-08 21:46:03,162 - validation.quality_checker - WARNING - Required field 'observationdate' has 24920 null values",
        "2026-02-08 21:46:03,164 - validation.quality_checker - WARNING - Required field 'temperature' has 2488 null values",
        "2026-02-08 21:46:03,182 - validation.quality_checker - WARNING - Required column 'observationdate' is only 50.2% complete",
        "2026-02-08 21:46:03,232 - validation.quality_checker - WARNING - Found 29 rows with >50% missing values",
        "2026-02-08 21:46:03,241 - validation.quality_checker - WARNING - Required field 'observationdate' has 24920 null values",
        "2026-02-08 21:46:03,244 - validation.quality_checker - WARNING - Required field 'temperature' has 2488 null values",
        "2026-02-08 21:46:03,535 - validation.schema_validator - WARNING - Found 680 rows with duplicate keys on ['stationcode']",
        "2026-02-08 21:46:03,538 - validation.quality_checker - WARNING - Found 82 exact duplicate rows (action: flag)",
        "2026-02-08 21:46:03,828 - validation.quality_checker - WARNING - Found 277 rows with >50% missing values",
        "2026-02-08 21:46:03,838 - validation.quality_checker - WARNING - Found 277 exact duplicate rows (action: flag)",
        "2026-02-08 21:46:03,844 - validation.quality_checker - WARNING - Required field 'activitydate' has 20029 null values",
        "2026-02-08 21:46:03,857 - validation.quality_checker - WARNING - Required column 'activitydate' is only 33.2% complete",
        "2026-02-08 21:46:03,883 - validation.quality_checker - WARNING - Found 277 rows with >50% missing values",
        "2026-02-08 21:46:03,891 - validation.quality_checker - WARNING - Required field 'activitydate' has 20029 null values"
      ],
      "required_column_completeness": [
        {
          "column": "observationdate",
          "completeness_pct": 50.2,
          "raw": "2026-02-08 19:34:03,555 - validation.quality_checker - WARNING - Required column 'observationdate' is only 50.2% complete"
        },
        {
          "column": "activitydate",
          "completeness_pct": 33.2,
          "raw": "2026-02-08 19:34:04,184 - validation.quality_checker - WARNING - Required column 'activitydate' is only 33.2% complete"
        },
        {
          "column": "observationdate",
          "completeness_pct": 50.2,
          "raw": "2026-02-08 19:43:14,260 - validation.quality_checker - WARNING - Required column 'observationdate' is only 50.2% complete"
        },
        {
          "column": "activitydate",
          "completeness_pct": 33.2,
          "raw": "2026-02-08 19:43:14,879 - validation.quality_checker - WARNING - Required column 'activitydate' is only 33.2% complete"
        },
        {
          "column": "observationdate",
          "completeness_pct": 50.2,
          "raw": "2026-02-08 19:58:28,016 - validation.quality_checker - WARNING - Required column 'observationdate' is only 50.2% complete"
        },
        {
          "column": "activitydate",
          "completeness_pct": 33.2,
          "raw": "2026-02-08 19:58:29,286 - validation.quality_checker - WARNING - Required column 'activitydate' is only 33.2% complete"
        },
        {
          "column": "observationdate",
          "completeness_pct": 50.2,
          "raw": "2026-02-08 20:01:49,902 - validation.quality_checker - WARNING - Required column 'observationdate' is only 50.2% complete"
        },
        {
          "column": "activitydate",
          "completeness_pct": 33.2,
          "raw": "2026-02-08 20:01:51,024 - validation.quality_checker - WARNING - Required column 'activitydate' is only 33.2% complete"
        },
        {
          "column": "observationdate",
          "completeness_pct": 50.2,
          "raw": "2026-02-08 20:03:04,897 - validation.quality_checker - WARNING - Required column 'observationdate' is only 50.2% complete"
        },
        {
          "column": "activitydate",
          "completeness_pct": 33.2,
          "raw": "2026-02-08 20:03:06,136 - validation.quality_checker - WARNING - Required column 'activitydate' is only 33.2% complete"
        },
        {
          "column": "observationdate",
          "completeness_pct": 50.2,
          "raw": "2026-02-08 21:46:03,182 - validation.quality_checker - WARNING - Required column 'observationdate' is only 50.2% complete"
        },
        {
          "column": "activitydate",
          "completeness_pct": 33.2,
          "raw": "2026-02-08 21:46:03,857 - validation.quality_checker - WARNING - Required column 'activitydate' is only 33.2% complete"
        }
      ],
      "duplicate_key_warnings": [
        {
          "duplicate_rows": 29008,
          "keys": "'stationid', 'observationdate'",
          "raw": "2026-02-08 19:34:03,495 - validation.schema_validator - WARNING - Found 29008 rows with duplicate keys on ['stationid', 'observationdate']"
        },
        {
          "duplicate_rows": 680,
          "keys": "'stationcode'",
          "raw": "2026-02-08 19:34:03,971 - validation.schema_validator - WARNING - Found 680 rows with duplicate keys on ['stationcode']"
        },
        {
          "duplicate_rows": 29008,
          "keys": "'stationid', 'observationdate'",
          "raw": "2026-02-08 19:43:14,196 - validation.schema_validator - WARNING - Found 29008 rows with duplicate keys on ['stationid', 'observationdate']"
        },
        {
          "duplicate_rows": 680,
          "keys": "'stationcode'",
          "raw": "2026-02-08 19:43:14,656 - validation.schema_validator - WARNING - Found 680 rows with duplicate keys on ['stationcode']"
        },
        {
          "duplicate_rows": 29008,
          "keys": "'stationid', 'observationdate'",
          "raw": "2026-02-08 19:58:27,850 - validation.schema_validator - WARNING - Found 29008 rows with duplicate keys on ['stationid', 'observationdate']"
        },
        {
          "duplicate_rows": 680,
          "keys": "'stationcode'",
          "raw": "2026-02-08 19:58:28,735 - validation.schema_validator - WARNING - Found 680 rows with duplicate keys on ['stationcode']"
        },
        {
          "duplicate_rows": 29008,
          "keys": "'stationid', 'observationdate'",
          "raw": "2026-02-08 20:01:49,709 - validation.schema_validator - WARNING - Found 29008 rows with duplicate keys on ['stationid', 'observationdate']"
        },
        {
          "duplicate_rows": 680,
          "keys": "'stationcode'",
          "raw": "2026-02-08 20:01:50,576 - validation.schema_validator - WARNING - Found 680 rows with duplicate keys on ['stationcode']"
        },
        {
          "duplicate_rows": 29008,
          "keys": "'stationid', 'observationdate'",
          "raw": "2026-02-08 20:03:04,734 - validation.schema_validator - WARNING - Found 29008 rows with duplicate keys on ['stationid', 'observationdate']"
        },
        {
          "duplicate_rows": 680,
          "keys": "'stationcode'",
          "raw": "2026-02-08 20:03:05,599 - validation.schema_validator - WARNING - Found 680 rows with duplicate keys on ['stationcode']"
        },
        {
          "duplicate_rows": 29008,
          "keys": "'stationid', 'observationdate'",
          "raw": "2026-02-08 21:46:03,101 - validation.schema_validator - WARNING - Found 29008 rows with duplicate keys on ['stationid', 'observationdate']"
        },
        {
          "duplicate_rows": 680,
          "keys": "'stationcode'",
          "raw": "2026-02-08 21:46:03,535 - validation.schema_validator - WARNING - Found 680 rows with duplicate keys on ['stationcode']"
        }
      ],
      "validation_summary": [
        {
          "passed": 19903,
          "total": 50000,
          "raw": "2026-02-08 19:34:03,603 - __main__ - INFO - Validation: 19903/50000 rows passed"
        },
        {
          "passed": 120,
          "total": 800,
          "raw": "2026-02-08 19:34:03,971 - __main__ - INFO - Validation: 120/800 rows passed"
        },
        {
          "passed": 30000,
          "total": 30000,
          "raw": "2026-02-08 19:34:04,204 - __main__ - INFO - Validation: 30000/30000 rows passed"
        },
        {
          "passed": 4,
          "total": 4,
          "raw": "2026-02-08 19:34:04,411 - __main__ - INFO - Validation: 4/4 rows passed"
        },
        {
          "passed": 19903,
          "total": 50000,
          "raw": "2026-02-08 19:43:14,295 - __main__ - INFO - Validation: 19903/50000 rows passed"
        },
        {
          "passed": 120,
          "total": 800,
          "raw": "2026-02-08 19:43:14,657 - __main__ - INFO - Validation: 120/800 rows passed"
        },
        {
          "passed": 30000,
          "total": 30000,
          "raw": "2026-02-08 19:43:14,911 - __main__ - INFO - Validation: 30000/30000 rows passed"
        },
        {
          "passed": 4,
          "total": 4,
          "raw": "2026-02-08 19:43:15,149 - __main__ - INFO - Validation: 4/4 rows passed"
        },
        {
          "passed": 19903,
          "total": 50000,
          "raw": "2026-02-08 19:58:28,144 - __main__ - INFO - Validation: 19903/50000 rows passed"
        },
        {
          "passed": 120,
          "total": 800,
          "raw": "2026-02-08 19:58:28,769 - __main__ - INFO - Validation: 120/800 rows passed"
        },
        {
          "passed": 30000,
          "total": 30000,
          "raw": "2026-02-08 19:58:29,320 - __main__ - INFO - Validation: 30000/30000 rows passed"
        },
        {
          "passed": 4,
          "total": 4,
          "raw": "2026-02-08 19:58:29,523 - __main__ - INFO - Validation: 4/4 rows passed"
        },
        {
          "passed": 19903,
          "total": 50000,
          "raw": "2026-02-08 20:01:50,035 - __main__ - INFO - Validation: 19903/50000 rows passed"
        },
        {
          "passed": 120,
          "total": 800,
          "raw": "2026-02-08 20:01:50,585 - __main__ - INFO - Validation: 120/800 rows passed"
        },
        {
          "passed": 30000,
          "total": 30000,
          "raw": "2026-02-08 20:01:51,100 - __main__ - INFO - Validation: 30000/30000 rows passed"
        },
        {
          "passed": 4,
          "total": 4,
          "raw": "2026-02-08 20:01:51,356 - __main__ - INFO - Validation: 4/4 rows passed"
        },
        {
          "passed": 19903,
          "total": 50000,
          "raw": "2026-02-08 20:03:05,024 - __main__ - INFO - Validation: 19903/50000 rows passed"
        },
        {
          "passed": 120,
          "total": 800,
          "raw": "2026-02-08 20:03:05,614 - __main__ - INFO - Validation: 120/800 rows passed"
        },
        {
          "passed": 30000,
          "total": 30000,
          "raw": "2026-02-08 20:03:06,176 - __main__ - INFO - Validation: 30000/30000 rows passed"
        },
        {
          "passed": 4,
          "total": 4,
          "raw": "2026-02-08 20:03:06,470 - __main__ - INFO - Validation: 4/4 rows passed"
        },
        {
          "passed": 19903,
          "total": 50000,
          "raw": "2026-02-08 21:46:03,248 - __main__ - INFO - Validation: 19903/50000 rows passed"
        },
        {
          "passed": 120,
          "total": 800,
          "raw": "2026-02-08 21:46:03,546 - __main__ - INFO - Validation: 120/800 rows passed"
        },
        {
          "passed": 30000,
          "total": 30000,
          "raw": "2026-02-08 21:46:03,893 - __main__ - INFO - Validation: 30000/30000 rows passed"
        },
        {
          "passed": 4,
          "total": 4,
          "raw": "2026-02-08 21:46:04,048 - __main__ - INFO - Validation: 4/4 rows passed"
        }
      ],
      "quality_summary": [
        {
          "passed": 23801,
          "total": 50000,
          "raw": "2026-02-08 19:34:03,603 - __main__ - INFO - Quality: 23801/50000 rows passed"
        },
        {
          "passed": 718,
          "total": 800,
          "raw": "2026-02-08 19:34:03,971 - __main__ - INFO - Quality: 718/800 rows passed"
        },
        {
          "passed": 9971,
          "total": 30000,
          "raw": "2026-02-08 19:34:04,204 - __main__ - INFO - Quality: 9971/30000 rows passed"
        },
        {
          "passed": 4,
          "total": 4,
          "raw": "2026-02-08 19:34:04,411 - __main__ - INFO - Quality: 4/4 rows passed"
        },
        {
          "passed": 23801,
          "total": 50000,
          "raw": "2026-02-08 19:43:14,295 - __main__ - INFO - Quality: 23801/50000 rows passed"
        },
        {
          "passed": 718,
          "total": 800,
          "raw": "2026-02-08 19:43:14,657 - __main__ - INFO - Quality: 718/800 rows passed"
        },
        {
          "passed": 9971,
          "total": 30000,
          "raw": "2026-02-08 19:43:14,911 - __main__ - INFO - Quality: 9971/30000 rows passed"
        },
        {
          "passed": 4,
          "total": 4,
          "raw": "2026-02-08 19:43:15,149 - __main__ - INFO - Quality: 4/4 rows passed"
        },
        {
          "passed": 23801,
          "total": 50000,
          "raw": "2026-02-08 19:58:28,146 - __main__ - INFO - Quality: 23801/50000 rows passed"
        },
        {
          "passed": 718,
          "total": 800,
          "raw": "2026-02-08 19:58:28,769 - __main__ - INFO - Quality: 718/800 rows passed"
        },
        {
          "passed": 9971,
          "total": 30000,
          "raw": "2026-02-08 19:58:29,322 - __main__ - INFO - Quality: 9971/30000 rows passed"
        },
        {
          "passed": 4,
          "total": 4,
          "raw": "2026-02-08 19:58:29,526 - __main__ - INFO - Quality: 4/4 rows passed"
        },
        {
          "passed": 23801,
          "total": 50000,
          "raw": "2026-02-08 20:01:50,035 - __main__ - INFO - Quality: 23801/50000 rows passed"
        },
        {
          "passed": 718,
          "total": 800,
          "raw": "2026-02-08 20:01:50,585 - __main__ - INFO - Quality: 718/800 rows passed"
        },
        {
          "passed": 9971,
          "total": 30000,
          "raw": "2026-02-08 20:01:51,103 - __main__ - INFO - Quality: 9971/30000 rows passed"
        },
        {
          "passed": 4,
          "total": 4,
          "raw": "2026-02-08 20:01:51,356 - __main__ - INFO - Quality: 4/4 rows passed"
        },
        {
          "passed": 23801,
          "total": 50000,
          "raw": "2026-02-08 20:03:05,024 - __main__ - INFO - Quality: 23801/50000 rows passed"
        },
        {
          "passed": 718,
          "total": 800,
          "raw": "2026-02-08 20:03:05,614 - __main__ - INFO - Quality: 718/800 rows passed"
        },
        {
          "passed": 9971,
          "total": 30000,
          "raw": "2026-02-08 20:03:06,176 - __main__ - INFO - Quality: 9971/30000 rows passed"
        },
        {
          "passed": 4,
          "total": 4,
          "raw": "2026-02-08 20:03:06,472 - __main__ - INFO - Quality: 4/4 rows passed"
        },
        {
          "passed": 23801,
          "total": 50000,
          "raw": "2026-02-08 21:46:03,249 - __main__ - INFO - Quality: 23801/50000 rows passed"
        },
        {
          "passed": 718,
          "total": 800,
          "raw": "2026-02-08 21:46:03,546 - __main__ - INFO - Quality: 718/800 rows passed"
        },
        {
          "passed": 9971,
          "total": 30000,
          "raw": "2026-02-08 21:46:03,894 - __main__ - INFO - Quality: 9971/30000 rows passed"
        },
        {
          "passed": 4,
          "total": 4,
          "raw": "2026-02-08 21:46:04,049 - __main__ - INFO - Quality: 4/4 rows passed"
        }
      ]
    },
    "narrative": {
      "mode": "gemini",
      "model": "gemini-2.5-flash",
      "text": "*   **`ingested_Activity Logs.csv`:** The `activitydate` column is critically incomplete, with 66.76% of values missing (only 33.2% complete for a required column). Additionally, `fertilizer_amount` is 14.92% missing and `irrigationhours` is 10.13% missing.\n*   **`ingested_Weather.csv`:** The `observationdate` column is significantly incomplete, with 49.84% of values missing (only 50.2% complete for a required column). Other substantial missing data includes `rain_unit` (19.87%), `rainfall` (9.9%), and `temperature` (4.98%). This dataset also contains 29008 duplicate rows based on `stationid` and `observationdate`.\n*   **`ingested_Station Region.csv`:** This dataset has 680 duplicate rows based on the `stationcode` key.\n*   **`ingested_Reference Units.csv`:** The `standard_unit` and `conversion_factor` columns both have 25.0% missing values.\n*   **Pipeline Stability:** Several pipeline errors occurred, including 2 instances of \"Input X contains NaN\" (likely related to missing data) and 2 instances of feature mismatch errors, indicating potential downstream processing failures due to data quality."
    }
  },
  "anomalies": {
    "datasets": {
      "weather": {
        "total_rows": 50000,
        "anomalies": 2500,
        "top_anomalies": [
          {
            "anomaly_score": 1.0,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 1.000)",
            "stationid": "S346",
            "observationdate": "2023-01-30",
            "temperature": 44.27433119318408,
            "rainfall": 0.2107320531999024
          },
          {
            "anomaly_score": 0.9944085134645024,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 0.994)",
            "stationid": "S371",
            "observationdate": "2023-01-29",
            "temperature": 43.39121230910064,
            "rainfall": 0.0377894947559187
          },
          {
            "anomaly_score": 0.9801960979743932,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 0.980)",
            "stationid": "S279",
            "observationdate": "2023-01-03",
            "temperature": 44.6328849454904,
            "rainfall": 0.320070240060416
          },
          {
            "anomaly_score": 0.956282083533104,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 0.956)",
            "stationid": "S230",
            "observationdate": "2023-01-13",
            "temperature": 44.25379105105102,
            "rainfall": 0.6265978202537825
          },
          {
            "anomaly_score": 0.9464122842012416,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 0.946)",
            "stationid": "S048",
            "observationdate": "2023-01-04",
            "temperature": 41.39940204267012,
            "rainfall": 0.3525379908654646
          },
          {
            "anomaly_score": 0.9453200163105692,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 0.945)",
            "stationid": "S029",
            "observationdate": "2023-01-23",
            "temperature": 36.66343583144092,
            "rainfall": 0.19959658228893
          },
          {
            "anomaly_score": 0.9318224538344,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 0.932)",
            "stationid": "S177",
            "observationdate": "2023-01-16",
            "temperature": null,
            "rainfall": 0.012155707875
          },
          {
            "anomaly_score": 0.9242496912563948,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 0.924)",
            "stationid": "S178",
            "observationdate": "2023-03-09",
            "temperature": 41.82752106964189,
            "rainfall": 0.1268993806264884
          },
          {
            "anomaly_score": 0.9226296780688134,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 0.923)",
            "stationid": "S079",
            "observationdate": "2023-01-26",
            "temperature": 43.07715441014209,
            "rainfall": 0.5780416693747348
          },
          {
            "anomaly_score": 0.9216290132797812,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 0.922)",
            "stationid": "S065",
            "observationdate": "2023-02-12",
            "temperature": 44.61761693794386,
            "rainfall": 0.5665099700109477
          },
          {
            "anomaly_score": 0.918590204952232,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 0.919)",
            "stationid": "S322",
            "observationdate": "2023-02-24",
            "temperature": 43.04585247271785,
            "rainfall": 0.3283498396688455
          },
          {
            "anomaly_score": 0.9183230081975796,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 0.918)",
            "stationid": "S091",
            "observationdate": "2023-02-05",
            "temperature": 43.75493154912,
            "rainfall": 0.5304204629156317
          },
          {
            "anomaly_score": 0.915255909033796,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 0.915)",
            "stationid": "S096",
            "observationdate": "2023-01-29",
            "temperature": 29.04482649834758,
            "rainfall": 0.0814215737874657
          },
          {
            "anomaly_score": 0.9150814373133052,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 0.915)",
            "stationid": "S180",
            "observationdate": "2023-02-02",
            "temperature": 37.45784439722384,
            "rainfall": 0.2994836239960941
          },
          {
            "anomaly_score": 0.9023722814541588,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier (score: 0.902)",
            "stationid": "S382",
            "observationdate": "2023-03-27",
            "temperature": 40.1932915892948,
            "rainfall": 0.2148421448766646
          }
        ]
      },
      "activity": {
        "total_rows": 30000,
        "anomalies": 1374,
        "top_anomalies": [
          {
            "anomaly_score": 1.0,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier in local neighborhood (score: 1.000)",
            "region": "unknown",
            "activitydate": "2023-05-19",
            "irrigationhours": null,
            "fertilizer_amount": null
          },
          {
            "anomaly_score": 0.9144864161082896,
            "is_anomaly": true,
            "anomaly_reason": "Missing activity date",
            "region": "unknown",
            "activitydate": null,
            "irrigationhours": 5.617074151757526,
            "fertilizer_amount": null
          },
          {
            "anomaly_score": 0.8850069927411767,
            "is_anomaly": true,
            "anomaly_reason": "Missing activity date",
            "region": "unknown",
            "activitydate": null,
            "irrigationhours": 5.494239874267086,
            "fertilizer_amount": null
          },
          {
            "anomaly_score": 0.8394434125384006,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier in local neighborhood (score: 0.839)",
            "region": "West ",
            "activitydate": "2023-04-13",
            "irrigationhours": null,
            "fertilizer_amount": null
          },
          {
            "anomaly_score": 0.7507359262456135,
            "is_anomaly": true,
            "anomaly_reason": "Missing activity date",
            "region": "unknown",
            "activitydate": null,
            "irrigationhours": null,
            "fertilizer_amount": 54.819635296717074
          },
          {
            "anomaly_score": 0.7298198099896092,
            "is_anomaly": true,
            "anomaly_reason": "Statistical outlier in local neighborhood (score: 0.730)",
            "region": "North",
            "activitydate": "2023-06-14",
            "irrigationhours": 5.985662848513651,
            "fertilizer_amount": 49.89587826498891
          },
          {
            "anomaly_score": 0.7140518567761128,
            "is_anomaly": true,
            "anomaly_reason": "Missing activity date",
            "region": "unknown",
            "activitydate": null,
            "irrigationhours": null,
            "fertilizer_amount": 47.205706233540326
          },
          {
            "anomaly_score": 0.7031532912542942,
            "is_anomaly": true,
            "anomaly_reason": "Missing activity date",
            "region": "unknown",
            "activitydate": null,
            "irrigationhours": null,
            "fertilizer_amount": 47.56264329923287
          },
          {
            "anomaly_score": 0.6979947089280887,
            "is_anomaly": true,
            "anomaly_reason": "Missing activity date",
            "region": "unknown",
            "activitydate": null,
            "irrigationhours": null,
            "fertilizer_amount": 47.59708376216747
          },
          {
            "anomaly_score": 0.6884072933593138,
            "is_anomaly": true,
            "anomaly_reason": "Missing activity date",
            "region": "unknown",
            "activitydate": null,
            "irrigationhours": null,
            "fertilizer_amount": 53.84434558466699
          },
          {
            "anomaly_score": 0.6750467457894269,
            "is_anomaly": true,
            "anomaly_reason": "Missing activity date",
            "region": "unknown",
            "activitydate": null,
            "irrigationhours": null,
            "fertilizer_amount": 47.91121894397728
          },
          {
            "anomaly_score": 0.6710492042886356,
            "is_anomaly": true,
            "anomaly_reason": "Missing activity date",
            "region": "unknown",
            "activitydate": null,
            "irrigationhours": null,
            "fertilizer_amount": 46.58388735754332
          },
          {
            "anomaly_score": 0.6670029772197156,
            "is_anomaly": true,
            "anomaly_reason": "Missing activity date",
            "region": "unknown",
            "activitydate": null,
            "irrigationhours": 6.28348057344177,
            "fertilizer_amount": null
          },
          {
            "anomaly_score": 0.6648295090156671,
            "is_anomaly": true,
            "anomaly_reason": "Missing activity date",
            "region": "unknown",
            "activitydate": null,
            "irrigationhours": null,
            "fertilizer_amount": 53.35636851175523
          },
          {
            "anomaly_score": 0.6545965900150728,
            "is_anomaly": true,
            "anomaly_reason": "Missing activity date",
            "region": "unknown",
            "activitydate": null,
            "irrigationhours": 6.255334745872259,
            "fertilizer_amount": 51.480647345912686
          }
        ]
      },
      "station": {
        "total_rows": 800,
        "anomalies": 8,
        "top_anomalies": [
          {
            "anomaly_score": 0.7320895059031696,
            "is_anomaly": true,
            "anomaly_reason": "Unusual observation count (920 vs regional avg 318)",
            "stationid": "S297",
            "stationcode": "S297",
            "region": " north"
          },
          {
            "anomaly_score": 0.725955803350194,
            "is_anomaly": true,
            "anomaly_reason": "Unusual observation count (920 vs regional avg 314)",
            "stationid": "S297",
            "stationcode": "S297",
            "region": "west"
          },
          {
            "anomaly_score": 0.725955803350194,
            "is_anomaly": true,
            "anomaly_reason": "Unusual observation count (920 vs regional avg 314)",
            "stationid": "S297",
            "stationcode": "S297",
            "region": "west"
          },
          {
            "anomaly_score": 0.6702197647320405,
            "is_anomaly": true,
            "anomaly_reason": "Unusual observation count (920 vs regional avg 357)",
            "stationid": "S297",
            "stationcode": "S297",
            "region": "unknown"
          },
          {
            "anomaly_score": 0.6702197647320405,
            "is_anomaly": true,
            "anomaly_reason": "Unusual observation count (920 vs regional avg 357)",
            "stationid": "S297",
            "stationcode": "S297",
            "region": "unknown"
          },
          {
            "anomaly_score": 0.6008538600591692,
            "is_anomaly": true,
            "anomaly_reason": "Unusual observation count (920 vs regional avg 352)",
            "stationid": "S297",
            "stationcode": "S297",
            "region": "SOUTH"
          },
          {
            "anomaly_score": 0.6008538600591692,
            "is_anomaly": true,
            "anomaly_reason": "Unusual observation count (920 vs regional avg 352)",
            "stationid": "S297",
            "stationcode": "S297",
            "region": "SOUTH"
          },
          {
            "anomaly_score": 0.6008538600591692,
            "is_anomaly": true,
            "anomaly_reason": "Unusual observation count (920 vs regional avg 352)",
            "stationid": "S297",
            "stationcode": "S297",
            "region": "SOUTH"
          }
        ]
      }
    },
    "narrative": {
      "mode": "gemini",
      "model": "gemini-2.5-flash",
      "text": "Here are explanations for the representative anomalies in each dataset, based on missing/invalid values and extreme magnitudes.\n\n---\n\n### Weather Dataset\n\nThe weather dataset shows anomalies primarily related to extreme temperature values and missing data.\n\n1.  **Station S177 on 2023-01-16 (Anomaly Score: 0.932)**\n    *   **Reason:** The `temperature` value is explicitly `NaN` (Not a Number), indicating a missing or invalid data point for a critical measurement. This makes the record anomalous as a data quality issue.\n\n2.  **Station S346 on 2023-01-30 (Anomaly Score: 1.000)**\n    *   **Reason:** The `temperature` of `44.27` is an extreme magnitude. Assuming typical temperature scales (e.g., Celsius), this is an exceptionally high temperature, far outside the expected range for January in most regions, making it a statistical outlier. If Fahrenheit, it's still notably high compared to typical daily averages, suggesting an unusual peak.\n\n3.  **Station S279 on 2023-01-03 (Anomaly Score: 0.980)**\n    *   **Reason:** Similar to S346, the `temperature` of `44.63` is another instance of an extreme high magnitude. This record stands out due to this unusually elevated temperature reading.\n\n4.  **Station S096 on 2023-01-29 (Anomaly Score: 0.915)**\n    *   **Reason:** The `temperature` of `29.04` represents an extreme low magnitude. While not as strikingly high as the 44+ degree readings, this temperature could be unusually cold, especially if the dataset typically records warmer climates or if this is outside the expected range for the station's location in late January.\n\n---\n\n### Activity Dataset\n\nAnomalies in the activity dataset are largely characterized by missing key information, often alongside an 'unknown' region.\n\n1.  **Region 'unknown' on 2023-05-19 (Anomaly Score: 1.000)**\n    *   **Reason:** Both `irrigationhours` and `fertilizer_amount` are `NaN`, meaning critical activity metrics are entirely missing for this record. The `region` being \"unknown\" further highlights a potential data completeness or categorization issue, making this a significant data quality anomaly.\n\n2.  **Region 'unknown' with `activitydate: NaN` (Anomaly Score: 0.914)**\n    *   **Reason:** The `activitydate` is `NaN`, indicating the specific date of the activity is missing. Additionally, `fertilizer_amount` is also `NaN`. Missing the date for an activity record is a fundamental data quality problem, making the record difficult to interpret or use for time-series analysis.\n\n3.  **Region 'West ' on 2023-04-13 (Anomaly Score: 0.839)**\n    *   **Reason:** Similar to the top anomaly, both `irrigationhours` and `fertilizer_amount` are `NaN`. Even though the `region` is known (\"West \"), the complete absence of data for these two crucial activity metrics makes this record highly anomalous due to severe data incompleteness.\n\n4.  **Region 'unknown' with `activitydate: NaN` (Anomaly Score: 0.751)**\n    *   **Reason:** The `activitydate` is `NaN`, and `irrigationhours` is also `NaN`. While `fertilizer_amount` is present, the absence of an activity date and one of the two key metrics severely impacts the record's utility and indicates significant data quality issues.\n\n5.  **Region 'North' on 2023-06-14 (Anomaly Score: 0.730)**\n    *   **Reason:** In this case, both `irrigationhours` (`5.98`) and `fertilizer_amount` (`49.89`) are present. The anomaly is due to these values being extreme magnitudes within their local neighborhood or compared to typical values for the 'North' region at that time of year, making it a statistical outlier despite no missing data.\n\n---\n\n### Station Dataset\n\nAll listed anomalies in the station dataset point to a single station with an unusual volume of observations.\n\n1.  **Station S297 in ' north' region (Anomaly Score: 0.732)**\n    *   **Reason:** This record is anomalous because `stationid` S297 has an \"Unusual observation count\" of 920. This count is significantly higher than the regional average of 318 for the ' north' region, indicating an extreme magnitude in data volume compared to its peers.\n\n2.  **Station S297 in 'west' region (Anomaly Score: 0.726)**\n    *   **Reason:** Again, `stationid` S297 shows an \"Unusual observation count\" of 920, which is an extreme magnitude compared to the regional average of 314 for the 'west' region. This consistently high observation count for a single station suggests it might be over-reporting or collecting data at a different frequency than other stations.\n\n3.  **Station S297 in 'unknown' region (Anomaly Score: 0.670)**\n    *   **Reason:** The `stationid` S297 is again flagged for an \"Unusual observation count\" of 920, which is an extreme magnitude against a regional average of 357. The 'unknown' region for this record, combined with the extreme observation count, could indicate both a data categorization issue and an operational anomaly for this particular station."
    }
  },
  "decision_support": {
    "narrative": {
      "mode": "gemini",
      "model": "gemini-2.5-flash",
      "text": "Data Quality Actions\n- Prioritize addressing the extremely high missing percentages for 'observationdate' (49.84%) in ingested_Weather.csv and 'activitydate' (66.76%) in ingested_Activity Logs.csv to ensure data completeness for time-series analysis.\n- Implement robust missing value handling for critical data points like 'rain_unit' (19.87%), 'rainfall' (9.9%), and 'temperature' (4.98%) in ingested_Weather.csv, and 'fertilizer_amount' (14.92%) and 'irrigationhours' (10.13%) in ingested_Activity Logs.csv, as these likely contribute to \"Input X contains NaN\" pipeline errors.\n- Investigate and correct the source of \"Pipeline failed: X has 8 features, but StandardScaler is expecting 5 features\" errors, which indicates a fundamental mismatch in data schema or processing steps.\n- Address the \"Failed to validate Weather.csv: Object of type Series is not JSON serializable\" error to ensure Weather.csv can be correctly parsed and used in the data pipeline.\n- Rectify the 25.0% missing data for both 'standard_unit' and 'conversion_factor' in ingested_Reference Units.csv to ensure accurate unit standardization across datasets.\n\nStation Maintenance\n- Investigate station 'S297' immediately due to repeated high anomaly scores and consistently high observation counts (920) significantly exceeding regional averages (e.g., 318, 314, 357).\n- Analyze the data collection mechanism for station 'S297' to determine if the \"Unusual observation count\" is due to sensor malfunction, misconfiguration, or genuine data influx.\n- Review the total of 8 anomalies detected across 800 station records (1% anomaly rate) to identify any other stations exhibiting unusual behavior beyond S297.\n- Cross-reference 'stationid' 'S297' with its associated regions (' north', 'west', 'unknown') to clarify regional assignments and ensure data consistency.\n\nSuspicious Activity Patterns\n- Conduct a deeper investigation into the 2500 weather anomalies (5% of total weather records) to identify specific patterns, locations, or timeframes for unusual weather events.\n- Analyze the 1374 activity anomalies (approximately 4.58% of total activity records) to understand if these relate to specific crop types, regions, or unusual operational practices.\n- Correlate weather anomalies with activity anomalies to determine if extreme weather conditions are influencing agricultural activities or vice-versa.\n- Review data collection processes for both weather and activity logs, especially considering the high missing percentages for 'observationdate' (49.84%) and 'activitydate' (66.76%), as incomplete data can mimic or obscure true anomalies.\n- Investigate if the missing 'rain_unit' (19.87%) and 'rainfall' (9.9%) in weather data contribute to or obscure anomalies related to precipitation."
    }
  },
  "audit": {
    "events_total": 68,
    "errors_total": 16,
    "errors_sample": [
      {
        "event_type": "error",
        "error_type": "TypeError",
        "error_message": "Object of type Series is not JSON serializable",
        "context": {
          "stage": "validation",
          "filename": "Weather.csv"
        },
        "timestamp": "2026-02-08T19:34:03.608556"
      },
      {
        "event_type": "error",
        "error_type": "KeyError",
        "error_message": "'valid_rows'",
        "context": {
          "stage": "filtering",
          "filename": "Weather.csv"
        },
        "timestamp": "2026-02-08T19:34:03.608556"
      },
      {
        "event_type": "error",
        "error_type": "TypeError",
        "error_message": "Object of type Series is not JSON serializable",
        "context": {
          "stage": "validation",
          "filename": "Station Region.csv"
        },
        "timestamp": "2026-02-08T19:34:03.971337"
      },
      {
        "event_type": "error",
        "error_type": "KeyError",
        "error_message": "'valid_rows'",
        "context": {
          "stage": "filtering",
          "filename": "Station Region.csv"
        },
        "timestamp": "2026-02-08T19:34:03.986981"
      },
      {
        "event_type": "error",
        "error_type": "TypeError",
        "error_message": "Object of type Series is not JSON serializable",
        "context": {
          "stage": "validation",
          "filename": "Activity Logs.csv"
        },
        "timestamp": "2026-02-08T19:34:04.204928"
      },
      {
        "event_type": "error",
        "error_type": "KeyError",
        "error_message": "'valid_rows'",
        "context": {
          "stage": "filtering",
          "filename": "Activity Logs.csv"
        },
        "timestamp": "2026-02-08T19:34:04.210212"
      },
      {
        "event_type": "error",
        "error_type": "TypeError",
        "error_message": "Object of type Series is not JSON serializable",
        "context": {
          "stage": "validation",
          "filename": "Reference Units.csv"
        },
        "timestamp": "2026-02-08T19:34:04.411858"
      },
      {
        "event_type": "error",
        "error_type": "KeyError",
        "error_message": "'valid_rows'",
        "context": {
          "stage": "filtering",
          "filename": "Reference Units.csv"
        },
        "timestamp": "2026-02-08T19:34:04.411858"
      },
      {
        "event_type": "error",
        "error_type": "TypeError",
        "error_message": "Object of type Series is not JSON serializable",
        "context": {
          "stage": "validation",
          "filename": "Weather.csv"
        },
        "timestamp": "2026-02-08T19:43:14.295562"
      },
      {
        "event_type": "error",
        "error_type": "KeyError",
        "error_message": "'valid_rows'",
        "context": {
          "stage": "filtering",
          "filename": "Weather.csv"
        },
        "timestamp": "2026-02-08T19:43:14.295562"
      }
    ]
  },
  "ml_performance": {
    "pipeline_metadata": {
      "generated_at": "2026-02-06T12:07:47.793595",
      "ml_pipeline_version": "1.0",
      "team": "ML Team - Anomaly Detection"
    },
    "models": {
      "weather": {
        "model_type": "Isolation Forest",
        "algorithm": "Isolation Forest",
        "contamination": 0.05,
        "n_features": 5,
        "features": [
          "temperature",
          "rainfall",
          "temp_rain_ratio",
          "month",
          "day_of_year"
        ]
      },
      "activity": {
        "model_type": "Local Outlier Factor",
        "algorithm": "Local Outlier Factor",
        "contamination": 0.05,
        "n_neighbors": 20,
        "n_features": 8,
        "features": [
          "irrigationhours",
          "fertilizer_amount",
          "croptype_encoded",
          "region_encoded",
          "fertilizer_per_hour",
          "month",
          "day_of_week",
          "day_of_month"
        ]
      },
      "station": {
        "model_type": "Statistical (Z-score)",
        "algorithm": "Statistical Z-Score",
        "z_threshold": 3.0,
        "n_regions": 7
      }
    },
    "performance": {
      "weather": {
        "total_samples": 50000,
        "anomalies_detected": 2500,
        "anomaly_rate": 0.05,
        "mean_anomaly_score": 0.18152832230548435
      },
      "activity": {
        "total_samples": 30000,
        "anomalies_detected": 1374,
        "anomaly_rate": 0.0458,
        "mean_anomaly_score": 0.012182975556833224
      },
      "station": {
        "total_samples": 800,
        "anomalies_detected": 8,
        "anomaly_rate": 0.01,
        "mean_anomaly_score": 0.23618438361167793
      }
    },
    "summary": {
      "total_datasets_processed": 3,
      "total_anomalies_detected": 3882,
      "output_files": [
        "anomaly_flagged_Weather.csv",
        "anomaly_flagged_Activity Logs.csv",
        "anomaly_flagged_Station Region.csv"
      ],
      "model_files": [
        "weather_isolation_forest.pkl",
        "activity_lof.pkl",
        "station_statistical.pkl"
      ]
    }
  }
}